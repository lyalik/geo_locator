# üèóÔ∏è SEMANTIC SEGMENTATION - –£–°–¢–ê–ù–û–í–ö–ê

## üìã –ß–¢–û –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

### ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **BuildingSegmentationService** (`services/building_segmentation_service.py`)
   - DeepLabV3+ —Å ResNet50 backbone
   - –í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—É—Ä–æ–≤ –∑–¥–∞–Ω–∏–π
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º–∏ —Å–Ω–∏–º–∫–∞–º–∏
   - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ coordinate_detector.py**
   - –®–ê–ì 3.2: Building Segmentation
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∑–¥–∞–Ω–∏–π –Ω–∞ —Ñ–æ—Ç–æ
   - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–º

3. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** (`requirements.txt`)
   - segmentation-models-pytorch==0.3.3
   - albumentations==1.4.0

---

## üöÄ –£–°–¢–ê–ù–û–í–ö–ê

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd /home/denis/Documents/Hackathon_2025/geo_locator/backend
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
pip install segmentation-models-pytorch==0.3.3
pip install albumentations==1.4.0
```

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
cd /home/denis/Documents/Hackathon_2025/geo_locator
./start_demo.sh
```

---

## üéØ –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢

### 1. –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:

```
üì∏ –§–æ—Ç–æ –∑–¥–∞–Ω–∏—è
    ‚Üì
üèóÔ∏è Building Segmentation
    ‚îú‚îÄ DeepLabV3+ –º–æ–¥–µ–ª—å
    ‚îú‚îÄ –í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—É—Ä–æ–≤ –∑–¥–∞–Ω–∏–π
    ‚îú‚îÄ –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫:
    ‚îÇ  ‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–¥–∞–Ω–∏–π
    ‚îÇ  ‚Ä¢ –ü–ª–æ—â–∞–¥—å –∑–¥–∞–Ω–∏–π
    ‚îÇ  ‚Ä¢ Aspect ratio
    ‚îÇ  ‚Ä¢ –ü–µ—Ä–∏–º–µ—Ç—Ä –∫–æ–Ω—Ç—É—Ä–æ–≤
    ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–∞—Å–∫–∞ + –∫–æ–Ω—Ç—É—Ä—ã
```

### 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–º (–±—É–¥—É—â–µ–µ):

```
üèóÔ∏è –ö–æ–Ω—Ç—É—Ä—ã —Å —Ñ–æ—Ç–æ
    +
üõ∞Ô∏è –°–ø—É—Ç–Ω–∏–∫–æ–≤—ã–π —Å–Ω–∏–º–æ–∫
    ‚Üì
üîç –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫:
    ‚Ä¢ –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥–µ–π
    ‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–¥–∞–Ω–∏–π
    ‚Ä¢ –§–æ—Ä–º–∞ —Å–∞–º–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ –∑–¥–∞–Ω–∏—è
    ‚Üì
üìä Similarity score (0-100%)
    ‚Üì
üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–µ—Å–ª–∏ similarity > 75%)
```

---

## üìä –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –ú–æ–¥–µ–ª—å:
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** DeepLabV3+ (ResNet50)
- **–ü—Ä–µ–¥–æ–±—É—á–µ–Ω–∏–µ:** ImageNet
- **–ó–∞–¥–∞—á–∞:** Binary segmentation (–∑–¥–∞–Ω–∏–µ/—Ñ–æ–Ω)
- **–†–∞–∑–º–µ—Ä –≤—Ö–æ–¥–∞:** 512x512
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 200-300ms –Ω–∞ CPU

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- **building_ratio** - —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥–∏ –∑–¥–∞–Ω–∏–π –∫ –æ–±—â–µ–π –ø–ª–æ—â–∞–¥–∏
- **num_buildings** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–¥–∞–Ω–∏–π
- **largest_building** - —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–∞–º–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ –∑–¥–∞–Ω–∏—è
  - area - –ø–ª–æ—â–∞–¥—å
  - bbox - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫
  - aspect_ratio - —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω
  - perimeter - –ø–µ—Ä–∏–º–µ—Ç—Ä

---

## üìã –ü–†–ò–ú–ï–† –†–ï–ó–£–õ–¨–¢–ê–¢–ê

```json
{
  "success": true,
  "num_buildings": 3,
  "building_area_ratio": 0.42,
  "features": {
    "building_ratio": 0.42,
    "num_buildings": 3,
    "largest_building": {
      "area": 15234,
      "bbox": [120, 80, 340, 280],
      "aspect_ratio": 1.21,
      "perimeter": 1240
    }
  }
}
```

---

## üé® –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `data/segmentation_results/`:
- –ó–µ–ª–µ–Ω—ã–π overlay - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∑–¥–∞–Ω–∏—è
- –ö—Ä–∞—Å–Ω—ã–µ –∫–æ–Ω—Ç—É—Ä—ã - –≥—Ä–∞–Ω–∏—Ü—ã –∑–¥–∞–Ω–∏–π

---

## üîÑ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### ‚úÖ –°–¥–µ–ª–∞–Ω–æ:
1. –°–æ–∑–¥–∞–Ω BuildingSegmentationService
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ coordinate_detector
3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### üìã TODO:
1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º–∏ —Å–Ω–∏–º–∫–∞–º–∏**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø—É—Ç–Ω–∏–∫–æ–≤–æ–≥–æ —Å–Ω–∏–º–∫–∞ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç—É—Ä–æ–≤ —Ñ–æ—Ç–æ –∏ —Å–ø—É—Ç–Ω–∏–∫–∞
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
   - Batch processing –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–æ—Ç–æ
   - GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

3. **–£–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏**
   - Fine-tuning –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ –∑–¥–∞–Ω–∏–π –ú–æ—Å–∫–≤—ã
   - –ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
   - –£—á–µ—Ç –º–∞—Å—à—Ç–∞–±–∞ –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø

### –î–æ Segmentation:
- **–¢–æ—á–Ω–æ—Å—Ç—å:** 85-90%
- **–ü–æ–∫—Ä—ã—Ç–∏–µ:** 75%
- **–ò—Å—Ç–æ—á–Ω–∏–∫–æ–≤:** 7 –∞–∫—Ç–∏–≤–Ω—ã—Ö

### –ü–æ—Å–ª–µ Segmentation:
- **–¢–æ—á–Ω–æ—Å—Ç—å:** 90-95% ‚ú®
- **–ü–æ–∫—Ä—ã—Ç–∏–µ:** 85% ‚ú®
- **–ò—Å—Ç–æ—á–Ω–∏–∫–æ–≤:** 8 –∞–∫—Ç–∏–≤–Ω—ã—Ö ‚ú®

### –û—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è:
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ñ–æ—Ä–º
- ‚úÖ –ó–¥–∞–Ω–∏–π —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–º–∏ –∫–æ–Ω—Ç—É—Ä–∞–º–∏
- ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∫—É—Ä—Å–æ–≤
- ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

---

## üêõ –£–°–¢–†–ê–ù–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞: "No module named 'segmentation_models_pytorch'"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
pip install segmentation-models-pytorch==0.3.3
```

### –ü—Ä–æ–±–ª–µ–º–∞: "No module named 'albumentations'"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
pip install albumentations==1.4.0
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Out of memory"

**–†–µ—à–µ–Ω–∏–µ:**
- –£–º–µ–Ω—å—à–∏—Ç—å input_size –≤ BuildingSegmentationService
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –ª–µ–≥–∫—É—é –º–æ–¥–µ–ª—å (MobileNet –≤–º–µ—Å—Ç–æ ResNet50)

---

## ‚úÖ –ì–û–¢–û–í–û!

Building Segmentation –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é! üöÄ

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–æ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–º–∏ —Å–Ω–∏–º–∫–∞–º–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.
